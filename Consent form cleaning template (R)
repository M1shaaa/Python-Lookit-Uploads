1. Loading Packages and Data
```{r, include = FALSE}
###################### 
#package that will search for the listed functions, install them if they're not there, and reference them if they are
####################

requiredPackages = c('readxl',
                     'ggplot2',
                     'reshape2',
                     'car',
                     'dplyr',
                     'plyr',
                     'lattice',
                     'aod',
                     'tidyverse',
                     'knitr',
                     'tidyr',
                     'doBy',
                     'psych',
                     'broom',
                     'geepack',
                     'gridExtra',
                     'grid',
                     'cowplot',
                     'lme4',
                     'devtools',
                     'stargazer',
                     'formattable',
                     'data.table',
                     'magrittr',
                     'corrplot',
                     'broom',
                     'MASS',
                     'ordinal',
                     'Hmisc',
                     'cowplot',
                     'interactions',
                     'mediation',
                     'bda',
                     'PerformanceAnalytics',
                     'janitor',
                     'ggpubr',
                     'pastecs',
                     'rjson',
                     'RJSONIO',
                     'rgeolocate',
                     'ggplot2',
                     'ggplot2',
                     'maps',
                     'mapproj',
                     'sjmisc')
for(p in requiredPackages){
  if(!require(p,character.only = TRUE)) install.packages(p)
  library(p,character.only = TRUE)
}
```

2. Read Data
```{r, include = FALSE}
raw <- read.csv(file = "")
```


3. Rename columns and make a dataset of kids
```{r, include = FALSE}
raw <- raw %>% dplyr::rename(AV_Consent=Q29, Participant_n=Q58, Child1_DOB=Q71_1_1, Child1_Gender=Q71_1_2, Child1_Ethn=Q71_1_3, Child2_DOB=Q71_2_1, Child2_Gender=Q71_2_2, Child2_Ethn=Q71_2_3, Child3_DOB=Q71_3_1, Child3_Gender=Q71_3_2, Child3_Ethn=Q71_3_3, Child4_DOB=Q71_4_1, Child4_Gender=Q71_4_2, Child4_Ethn=Q71_4_3, Consent_Month=Q52.1_1, Consent_Day=Q52.2_1, Consent_Year=Q52.3_1, Study_Month=Q56.1_1, Study_Day=Q56.2_1, Study_Year=Q56.3_1)

# Making a dataset of kids (including repeat visits)
DeIdentified <- raw[-(1:2),-(1:7)] %>% dplyr::filter(Q43=="") %>% dplyr::select(RecordedDate, Consent, AV_Consent, Participant_n:Study_Year, Parent1.Gender:Parent.2.Political) %>%
  dplyr::filter(Study_Year==2022)
```


4. DATASET WITH NO DUPLICATES:

Making a dataset of kids with no duplicates. I used parent name, but we could use something else to decide when kids are duplicates.
```{r, include = FALSE}
DeIdentified_NoDuplicates <- raw[-(1:2), ] %>% 
  dplyr::filter(Q43 != "") %>%
  dplyr::distinct(Q43, .keep_all = TRUE)

#If you want to filter by the year
#dplyr::filter(Study_Year==2022)
```



5. This is the new dataset. I'm just keeping the old column names, and adding a participation column name
```{r, include = FALSE}
DEID_ND <- raw[-(1:1500),] 
DEID_ND[1,]=NA
DEID_ND$n_Appointments <- NA
```




6. I wrote the following function to remove duplicates. Summary of the function is below and details for each line of code are included: Take the participant name; Search for participant name in participant name column; If match ==1, then add to database; If match >=2, then take all matches and add to a different database; Check for most complete version; Keep all with most complete version; Check date. Keep one with the most recent date; This results in prioritizing completion then date; Add to the database.

```{r, include = FALSE}
for(i in 1:nrow(DeIdentified_NoDuplicates)) { 
  ParentName <- DeIdentified_NoDuplicates$Q43[i]      # Takes the parent name for a certain row
  NoMatches <- nrow(DeIdentified_NoDuplicates %>% filter(Q43==ParentName))      # Checks if there are duplicates for that name
  if(NoMatches==1){       # If there are no duplicates, it just adds it as a new row to the DEID_ND dataset
    Matches <- DeIdentified_NoDuplicates[i,]
    Matches$n_Appointments <- 1
    DEID_ND <- rbind(DEID_ND, Matches[1,]) 
  }
  if(NoMatches!=1){       # If there are duplicates however...
    Matches <- DeIdentified_NoDuplicates[DeIdentified_NoDuplicates$Q43 == ParentName,] # It creates a new dataset (Matches) with all of the matches
    Matches$count.blank <- apply(Matches, 1, function(x) length(which(x=="")))  # And creates a new column that tells us how much of the survey parents filled out (The Progress column does not accurately do this)
    Matches$maxfill <- ifelse(Matches$count.blank==min(Matches$count.blank), "YES", "NO")   # Then it creates another column to decide which row is the most complete version of the form
    ifelse(str_count(Matches$maxfill, "YES")==1,   # If only one form is the most complete version...
           (Matches <- Matches[which.min(Matches$count.blank),]),  # It filters the Matches dataframe so that only the most complete record remains
           (Matches <- Matches %>% filter(Matches$maxfill=="YES") %>%   # Otherwise, i.e. if there are multiple "most complete" versions...
            separate(col=RecordedDate,into=c("Date","Time"),sep=" ") %>%   # (This code is just making the date readable to R)
            dplyr::slice(which.min(base::as.Date(Date, "%Y-%m-%d"))) %>%  # It will choose the most recent version of the form
      tidyr::unite("RecordedDate", Date:Time, remove=TRUE, sep = " ")))   # Re-making the RecordedDate column
    Matches <- Matches %>% dplyr::select(-count.blank, -maxfill)  # Finally, this piece of code removes all the extra columns we added 
    Matches$n_Appointments <- NoMatches
    DEID_ND <- rbind(DEID_ND, Matches[1,]) # And adds the record to the DEID_ND dataframe.
  }
}

# Since it does this for every row (meaning including each time for all duplicate records), we have to delete duplicates. Since all of the duplicate records are the exact same, we can delete them easily:

DEID_ND <- DEID_ND[!duplicated(DEID_ND$Q43), -(1:7)] %>% dplyr::select(RecordedDate, Consent, AV_Consent, 
                                                      Participant_n:Study_Year, Parent1.Gender:n_Appointments) 

# Graphing it:
DeID_Final %>% group_by(n_Appointments) %>% dplyr::summarise(mean=mean(n_Appointments), number_Appointments = n()) %>%
  ggplot(aes(x=as.factor(n_Appointments),y= number_Appointments, fill=as.factor(n_Appointments))) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = number_Appointments), vjust = 0) +
  labs(title = "How many times does each child participate in one year?", x= "Number of times participated", y="Number of children") 

DEID_ND %>% group_by(n_Appointments) %>% dplyr::summarise(mean=mean(n_Appointments), number_Appointments = n()) %>%
  ggplot(aes(x=as.factor(n_Appointments),y= number_Appointments, fill=as.factor(n_Appointments))) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = number_Appointments), vjust = 0) +
  labs(title = "How many times does each family participate in one year?", x= "Number of times participated", y="Number of families")
```



7. Clean Data: 
```{r, include = FALSE}
# Removing the NA row
DEID_ND <- DEID_ND[-(1),]

# Making family ids
DEID_ND$id <- c(1:nrow(DEID_ND))

# Creating a new dataframe
DeID_Final <- DEID_ND

#Adding new row for 2nd kid
DeID_Final <- rbind(DeID_Final,
      DeID_Final %>% 
        filter(Participant_n==2) %>% 
        mutate(Child1_DOB=Child2_DOB,
               Child1_Gender=Child2_Gender,
               Child1_Ethn=Child2_Ethn))

#Adding new row for 3rd kid
DeID_Final <- rbind(DeID_Final,
      DeID_Final %>% 
        filter(Participant_n==3) %>% 
        mutate(Child1_DOB=Child3_DOB,
               Child1_Gender=Child3_Gender,
               Child1_Ethn=Child3_Ethn),
      DeID_Final %>% 
        filter(Participant_n==3) %>% 
        mutate(Child1_DOB=Child3_DOB,
               Child1_Gender=Child3_Gender,
               Child1_Ethn=Child3_Ethn))

#Adding new row for 4th kid
DeID_Final <- rbind(DeID_Final,
      DeID_Final %>% 
        filter(Participant_n==4) %>% 
        mutate(Child1_DOB=Child4_DOB,
               Child1_Gender=Child4_Gender,
               Child1_Ethn=Child4_Ethn), 
      DeID_Final %>% 
        filter(Participant_n==4) %>% 
        mutate(Child1_DOB=Child3_DOB,
               Child1_Gender=Child3_Gender,
               Child1_Ethn=Child3_Ethn),
      DeID_Final %>% 
        filter(Participant_n==4) %>% 
        mutate(Child1_DOB=Child2_DOB,
               Child1_Gender=Child2_Gender,
               Child1_Ethn=Child2_Ethn))

#Deleting columns for more than 1 kid
DeID_Final <- DeID_Final %>% dplyr::select(-starts_with("Child2"),-starts_with("Child3"),-starts_with("Child4"))
```

8. Making the Free responses consistent: 

DOB
```{r, include = FALSE}
#DOB
DeID_Final$Child_DOB <- DeID_Final$Child1_DOB
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "01"] <- "01/26/2017" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "01/03/207"] <- "01/03/2017" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "01/05/14"] <- "01/05/2014" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "01/05/17"] <- "01/05/2017" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "01/07/19"] <- "01/07/2019" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "01/14/18"] <- "01/14/2018" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "01/18/18"] <- "01/18/2018" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "01/30/2017"] <- "01/30/2017" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "01052018"] <- "01/05/2018" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "01182014"] <- "01/18/2014" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "01302016"] <- "01/30/2016" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "02/08/14"] <- "02/08/2014" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "02/15/2017"] <- "02/15/17" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "02262014"] <- "02/26/2014" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "04" & DeID_Final$Child1_Gender=="19"] <- "04/19/2013" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "04" & DeID_Final$Child1_Gender=="03"] <- "04/03/2015" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "040/01/2016"] <- "04/01/2016" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "04022014"] <- "04/02/2014" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "04082012"] <- "04/08/2012" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "05"] <- "05/15/2013" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "05/2018"] <- "05/01/2018" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "05232011"] <- "05/23/2011" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "05252017"] <- "05/25/2017" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "06"] <- "06/25/" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "06/18^2015"] <- "06/18/2015" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "06142018"] <- "06/14/2018" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "06202014"] <- "06/20/2014" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "06252013"] <- "06/25/2013" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "07042015"] <- "07/04/2015" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "07052014"] <- "07/05/2014" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "07052017"] <- "07/05/2017" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "07062017"] <- "07/06/2017" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "08/01/0212"] <- "08/01/2012" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "08/30"] <- "08/30/" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "08152012"] <- "08/15/2012" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "08192015"] <- "08/19/2015" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "08202012"] <- "08/20/2012" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "09" & DeID_Final$Child1_Gender=="21"] <- "09/21/2009" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "09" & DeID_Final$Child1_Gender=="01"] <- "09/01/2014" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "09-01-2013 "] <- "09/01/2013 " 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "09042017"] <- "09/04/2017" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "09092015"] <- "09/09/2015" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "09302011"] <- "09/30/2011" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "10-09/2016"] <- "10/09/2016" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "102512"] <- "10/25/2012" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "11" & DeID_Final$Child1_Gender=="F"] <- "11//" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "11" & DeID_Final$Child1_Gender=="01"] <- "11/01/2015" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "12082015"] <- "12/08/2015" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "2015"] <- "//2015" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "2016"] <- "//2016" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "21/10/2016"] <- "10/21/2016" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "3/31/2-14"] <- "3/31/2014" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "32617"] <- "3/26/2017" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == "6"] <- "6//" 
DeID_Final$Child_DOB[DeID_Final$Child1_DOB == ""] <- "" 

DeID_Final$Child_DOB1 <-DeID_Final$Child_DOB

DeID_Final$Child_DOB1 <- as.Date(DeID_Final$Child_DOB, "%m/%d/%Y", optional = TRUE)
DeID_Final$Child_DOB_MonthYear <- format(DeID_Final$Child_DOB1, format="%m/%Y")


DeID_Final$Consent_Date <- as.Date(paste(DeID_Final$Consent_Day, DeID_Final$Consent_Month, DeID_Final$Consent_Year, sep="-"), "%d-%B-%Y", optional = TRUE)

DeID_Final$Study_Date <- as.Date(paste(DeID_Final$Study_Day, DeID_Final$Study_Month, DeID_Final$Study_Year, sep="-"), "%d-%B-%Y", optional = TRUE)

DeID_Final$Child_Age <- as.numeric((DeID_Final$Study_Date - DeID_Final$Child_DOB1)/365)

DeID_ForAnalysis <- DeID_Final %>% dplyr::select(-RecordedDate, -Child1_DOB, -Child_DOB, -Child_DOB1)
DeID_Final$Child1_DOB = NULL
DeID_Final$Child_DOB = NULL
DeID_Final$Child_DOB1 = NULL
DeID_ForAnalysis$Child1_DOB = NULL
DeID_ForAnalysis$Child_DOB = NULL
```

 

Child Gender (will need to be updated year after year)
```{r, echo=FALSE}
#Gender
DeID_Final$Child_Gender <- DeID_Final$Child1_Gender
DeID_Final$Child_Gender[DeID_Final$Child_Gender == "M" | 
                         DeID_Final$Child_Gender == "m"|
                          DeID_Final$Child_Gender == "Boy"|
                           DeID_Final$Child_Gender == "male"|
                          DeID_Final$Child_Gender == "male "|
                          DeID_Final$Child_Gender == "Male "|
                           DeID_Final$Child_Gender == "MALE"|
                           DeID_Final$Child_Gender == "Maoe"|
                          DeID_Final$Child_Gender == "Make "] <- "Male" 

DeID_Final$Child_Gender[DeID_Final$Child_Gender == "F" | 
                         DeID_Final$Child_Gender == "f" |
                          DeID_Final$Child_Gender == "F " |
                           DeID_Final$Child_Gender == "female"|
                           DeID_Final$Child_Gender == "Girl"|
                          DeID_Final$Child_Gender == "FEMALE"|
                          DeID_Final$Child_Gender == "FEMALE "|
                          DeID_Final$Child_Gender == "Female "] <- "Female" 

DeID_Final$Child_Gender[DeID_Final$Child_Gender == "" | 
                         DeID_Final$Child_Gender == "01"|
                           DeID_Final$Child_Gender == "03"|
                           DeID_Final$Child_Gender == "15"|
                          DeID_Final$Child_Gender == "19"|
                          DeID_Final$Child_Gender == "21"|
                           DeID_Final$Child_Gender == "25"|
                          DeID_Final$Child_Gender == "05"|
                          DeID_Final$Child_Gender == "11"|
                          DeID_Final$Child_Gender == "11"|
                           DeID_Final$Child_Gender == "30"|
                          DeID_Final$Child_Gender == "x"|
                          DeID_Final$Child_Gender == "26"|
                          DeID_Final$Child_Gender == "6"] <- "Blank" 

DeID_Final$Child_Gender[DeID_Final$Child_Gender == "Non binary"|
                        DeID_Final$Child_Gender == "Non binary "] <- "Non-Binary" 

table(DeID_Final$Child_Gender)
```

Making the Free responses consistent: 
Child Ethnicity (will need to be updated year after year)
```{r, echo=FALSE}
#Ethnicity
DeID_Final$Child_Ethn <- DeID_Final$Child1_Ethn
DeID_Final$Child_Ethn[DeID_Final$Child_Ethn == "white"|
                         DeID_Final$Child_Ethn == "White "|
                         DeID_Final$Child_Ethn == "Whitr"|
                         DeID_Final$Child_Ethn == "Wht "|
                         DeID_Final$Child_Ethn == "White, non-Hispanic"|
                         DeID_Final$Child_Ethn == "white/non-hispanic"|
                         DeID_Final$Child_Ethn == "White non hispanic"|
                         DeID_Final$Child_Ethn == "WHITE"|
                         DeID_Final$Child_Ethn == "White/ Caucasian "| 
                         DeID_Final$Child_Ethn == "Caucashion"| 
                         DeID_Final$Child_Ethn == "Caucasi"| 
                         DeID_Final$Child_Ethn == "Cauc."| 
                         DeID_Final$Child_Ethn == "White/non Hispanic "|
                         DeID_Final$Child_Ethn == "white "|
                         DeID_Final$Child_Ethn == "Caucasian "| 
                         DeID_Final$Child_Ethn == "Caucasian"|
                         DeID_Final$Child_Ethn == "White Caucasian"|
                         DeID_Final$Child_Ethn == "White Caucasian "|
                         DeID_Final$Child_Ethn == "caucasian"| 
                         DeID_Final$Child_Ethn == "caucasian "| 
                         DeID_Final$Child_Ethn == "Caucasian, Non-Hispanic"| 
                         DeID_Final$Child_Ethn == "Caucasian/non-Hispanic"| 
                         DeID_Final$Child_Ethn == "Caucasian/White"| 
                         DeID_Final$Child_Ethn == "Caucasion"] <- "White" 

DeID_Final$Child_Ethn[DeID_Final$Child_Ethn == "asian"|
                         DeID_Final$Child_Ethn == "ASIAN"|
                         DeID_Final$Child_Ethn == "Asian "|
                         DeID_Final$Child_Ethn == "Vietnamese "|
                         DeID_Final$Child_Ethn == "Asiann"|
                         DeID_Final$Child_Ethn == "Southeast Asian "|
                         DeID_Final$Child_Ethn == "South Asian"|
                         DeID_Final$Child_Ethn == "south east indian"|
                         DeID_Final$Child_Ethn == "Asian indian"|
                         DeID_Final$Child_Ethn == "Central Asian"|
                         DeID_Final$Child_Ethn == "Chinese"|
                         DeID_Final$Child_Ethn == "Asian, Indian "|
                         DeID_Final$Child_Ethn == "Asian American"|
                         DeID_Final$Child_Ethn == "Asian American "|
                         DeID_Final$Child_Ethn == "AISAN"|
                         DeID_Final$Child_Ethn == "Pakistani "|
                         DeID_Final$Child_Ethn == "Asian XO"|
                         DeID_Final$Child_Ethn == "AsianAmerican"] <- "Asian" 

DeID_Final$Child_Ethn[DeID_Final$Child_Ethn == "Black "|
                         DeID_Final$Child_Ethn == "Blk"|
                         DeID_Final$Child_Ethn == "African American "|
                         DeID_Final$Child_Ethn == "African/American"|
                         DeID_Final$Child_Ethn == "African"|
                         DeID_Final$Child_Ethn == "african/black"|
                         DeID_Final$Child_Ethn == "african/black "|
                         DeID_Final$Child_Ethn == "Bleack"|
                         DeID_Final$Child_Ethn == "Black African American "|
                         DeID_Final$Child_Ethn == "Black American"|
                         DeID_Final$Child_Ethn == "black "|
                         DeID_Final$Child_Ethn == "blacks "|
                         DeID_Final$Child_Ethn == "Blacks "|
                         DeID_Final$Child_Ethn == "BLACK"|
                         DeID_Final$Child_Ethn == "BLACK "|
                         DeID_Final$Child_Ethn == "Black  America "|
                         DeID_Final$Child_Ethn == "Black american"|
                         DeID_Final$Child_Ethn == "Black American "|
                         DeID_Final$Child_Ethn == "African American"|
                         DeID_Final$Child_Ethn == "Blk "] <- "Black" 

DeID_Final$Child_Ethn[DeID_Final$Child_Ethn == "hispanic "|
                         DeID_Final$Child_Ethn == "HISPANIC"|
                         DeID_Final$Child_Ethn == "Hispanic "|
                         DeID_Final$Child_Ethn == "Hispanic"|
                         DeID_Final$Child_Ethn == "Latina"|
                         DeID_Final$Child_Ethn == "Latino"|
                         DeID_Final$Child_Ethn == "latino"|
                         DeID_Final$Child_Ethn == "His"|
                         DeID_Final$Child_Ethn == "Puerto Rico"|
                         DeID_Final$Child_Ethn == "Latin"|
                         DeID_Final$Child_Ethn == "Latin "|
                         DeID_Final$Child_Ethn == "hispanic"] <- "Hispanic/Latino"

DeID_Final$Child_Ethn[DeID_Final$Child_Ethn == "PACIFIC ISLANDER (CHAMORRU, FILIPINO, CHINESE)"|
                         DeID_Final$Child_Ethn == "PI"|
                         DeID_Final$Child_Ethn == "Pacific Islander"|
                         DeID_Final$Child_Ethn == "Asian-Pacific Islander"|
                         DeID_Final$Child_Ethn == "Filipino American"] <- "Pacific Islander" 

DeID_Final$Child_Ethn[DeID_Final$Child_Ethn == "Middle eastern"|
                         DeID_Final$Child_Ethn == "Arab"|
                         DeID_Final$Child_Ethn == "Middle Eastern"|
                         DeID_Final$Child_Ethn == "middle eastern "|
                         DeID_Final$Child_Ethn == "North Africa "|
                         DeID_Final$Child_Ethn == "Middle eastern "] <- "Middle Eastern" 

DeID_Final$Child_Ethn[DeID_Final$Child_Ethn == "Alaska Native"|
                         DeID_Final$Child_Ethn == "indian american "|
                         DeID_Final$Child_Ethn == "indi"|
                         DeID_Final$Child_Ethn == "Indi"|
                         DeID_Final$Child_Ethn == "indian"|
                         DeID_Final$Child_Ethn == "INDIAN"|
                         DeID_Final$Child_Ethn == "West indian"|
                         DeID_Final$Child_Ethn == "West Indian"|
                         DeID_Final$Child_Ethn == "Indian"|
                         DeID_Final$Child_Ethn == "American Indian "|
                         DeID_Final$Child_Ethn == "American Indian/Alaskan Native"|
                         DeID_Final$Child_Ethn == "Indian "|
                         DeID_Final$Child_Ethn == "Appalachian "] <- "American Indian/Alaskan Native" 

DeID_Final$Child_Ethn[DeID_Final$Child_Ethn == "Hmong"] <- "Hmong"

DeID_Final$Child_Ethn[DeID_Final$Child_Ethn == "Multi"|
                         DeID_Final$Child_Ethn == "Multiracial"|
                         DeID_Final$Child_Ethn == "Multiple"|
                         DeID_Final$Child_Ethn == "mixed"|
                         DeID_Final$Child_Ethn == "Caucasian & Pacific Islander"|
                         DeID_Final$Child_Ethn == "Caucasian/Asian "|
                         DeID_Final$Child_Ethn == "Mixed"|
                         DeID_Final$Child_Ethn == "Black/white "|
                         DeID_Final$Child_Ethn == "W/A"|
                         DeID_Final$Child_Ethn == "B/w"|
                         DeID_Final$Child_Ethn == "Mixed - Asian/White"|
                         DeID_Final$Child_Ethn == "W/C"|
                         DeID_Final$Child_Ethn == "Mixed - Asian-White"|
                         DeID_Final$Child_Ethn == "W/B"|
                         DeID_Final$Child_Ethn == "H/AA"|
                         DeID_Final$Child_Ethn == "Wh/Hisp"|
                         DeID_Final$Child_Ethn == "White and Asian American"|
                         DeID_Final$Child_Ethn == "White/middle eastern "|
                         DeID_Final$Child_Ethn == "White/Latino "|
                         DeID_Final$Child_Ethn == "H/AA "|
                         DeID_Final$Child_Ethn == "White/Latino"|
                         DeID_Final$Child_Ethn == "White/Latina"|
                         DeID_Final$Child_Ethn == "Black/White/Non-Hispanic"|
                         DeID_Final$Child_Ethn == "ASIAN INDIAN"|
                         DeID_Final$Child_Ethn == "Asian-Indian"|
                         DeID_Final$Child_Ethn == "asian, white"|
                         DeID_Final$Child_Ethn == "White/mexican"|
                         DeID_Final$Child_Ethn == "White/API"|
                         DeID_Final$Child_Ethn == "White/ Black"|
                         DeID_Final$Child_Ethn == "white, asian"|
                         DeID_Final$Child_Ethn == "asian/white"|
                         DeID_Final$Child_Ethn == "b/w"|
                         DeID_Final$Child_Ethn == "W&L"|
                         DeID_Final$Child_Ethn == "W/H"|
                         DeID_Final$Child_Ethn == "Wh/Hispanic"|
                         DeID_Final$Child_Ethn == "White/Hispanic "|
                         DeID_Final$Child_Ethn == "White/Hispanic"|
                         DeID_Final$Child_Ethn == "White/hispanic"|
                         DeID_Final$Child_Ethn == "White/Asian "|
                         DeID_Final$Child_Ethn == "chinese white"|
                         DeID_Final$Child_Ethn == "Wh/Hispanic "|
                         DeID_Final$Child_Ethn == "Asian white"|
                         DeID_Final$Child_Ethn == "White and Filipino"|
                         DeID_Final$Child_Ethn == "Asian white "|
                         DeID_Final$Child_Ethn == "Asian/Hispanic"|
                         DeID_Final$Child_Ethn == "White/Asian"|
                         DeID_Final$Child_Ethn == "White/asian"|
                         DeID_Final$Child_Ethn == "white, mexican, native american"|
                         DeID_Final$Child_Ethn == "White/ Hispan"|
                         DeID_Final$Child_Ethn == "White/Mex "|
                         DeID_Final$Child_Ethn == "White/Mexican"|
                         DeID_Final$Child_Ethn == "white/asian"|
                         DeID_Final$Child_Ethn == "White/Hispanic/Native American" |
                         DeID_Final$Child_Ethn == "White/Arab"|
                         DeID_Final$Child_Ethn == "white / latino / Native American"|
                         DeID_Final$Child_Ethn == "Asian and Caucasian"|
                         DeID_Final$Child_Ethn == "Asian Caucasian"|
                         DeID_Final$Child_Ethn == "White/ middle eastern "|
                         DeID_Final$Child_Ethn == "white/ hispanic"|
                         DeID_Final$Child_Ethn == "White/ Chinese"|
                         DeID_Final$Child_Ethn == "White Latino"|
                         DeID_Final$Child_Ethn == "White Hispanic"|
                         DeID_Final$Child_Ethn == "Mixed"|
                         DeID_Final$Child_Ethn == "Mixed "|
                         DeID_Final$Child_Ethn == "Japanese and Caicasian"|
                         DeID_Final$Child_Ethn == "Japanese / White"|
                         DeID_Final$Child_Ethn == "Caucasian/Asian"|
                         DeID_Final$Child_Ethn == "Caucasian/Taiwanese"|
                         DeID_Final$Child_Ethn == "caucasian/jewish"|
                         DeID_Final$Child_Ethn == "caucasian-jewish"|
                         DeID_Final$Child_Ethn == "East Asian/white"|
                         DeID_Final$Child_Ethn == "Asian/African American"|
                         DeID_Final$Child_Ethn == "Asian/African American "|
                         DeID_Final$Child_Ethn == "asian/white"|
                         DeID_Final$Child_Ethn == "Asian/white"|
                         DeID_Final$Child_Ethn == "Asian/White"|
                         DeID_Final$Child_Ethn == "B/W"|
                         DeID_Final$Child_Ethn == "biracial"|
                         DeID_Final$Child_Ethn == "Biracial"|
                         DeID_Final$Child_Ethn == "Biracial "|
                         DeID_Final$Child_Ethn == "biracial black white"|
                         DeID_Final$Child_Ethn == "Black hispanic"|
                         DeID_Final$Child_Ethn == "Black/Hispanic"|
                         DeID_Final$Child_Ethn == "Black/White"|
                         DeID_Final$Child_Ethn == "British white indian"|
                         DeID_Final$Child_Ethn == "Chinese Caucasian "|
                         DeID_Final$Child_Ethn == "hispanic/white"|
                         DeID_Final$Child_Ethn == "Haitian/Panamanian/Irish/Italian "|
                         DeID_Final$Child_Ethn == "Hispanic white"|
                         DeID_Final$Child_Ethn == "Hispanic/white"|
                         DeID_Final$Child_Ethn == "Hispanic/White"|
                         DeID_Final$Child_Ethn == "mexican white"|
                         DeID_Final$Child_Ethn == "Indian-persian"|
                         DeID_Final$Child_Ethn == "Caucasian and Asian"|
                         DeID_Final$Child_Ethn == "Chinese white"|
                         DeID_Final$Child_Ethn == "Indian-persian"|
                         DeID_Final$Child_Ethn == "multiracial"|
                         DeID_Final$Child_Ethn == "multi"|
                          DeID_Final$Child_Ethn == "Asian/white "|
                         DeID_Final$Child_Ethn == "Indian-Persian"|
                         DeID_Final$Child_Ethn == "Indian-Persian "|
                         DeID_Final$Child_Ethn == "Asian and White"|
                         DeID_Final$Child_Ethn == "Hispanic/asian"] <- "Multiple Categories"


#Uncategorizable (One letter responses like "H" or "CH")
DeID_Final$Child_Ethn[DeID_Final$Child_Ethn == "H"|
                         DeID_Final$Child_Ethn == "h"|
                         DeID_Final$Child_Ethn == "L"| 
                         DeID_Final$Child_Ethn == "c"|
                         DeID_Final$Child_Ethn == "C"|
                         DeID_Final$Child_Ethn == "A"|
                         DeID_Final$Child_Ethn == "N/a"|
                         DeID_Final$Child_Ethn == "Non hospianic"|
                         DeID_Final$Child_Ethn == "B"|
                         DeID_Final$Child_Ethn == "Yes" |
                         DeID_Final$Child_Ethn == "x" |
                         DeID_Final$Child_Ethn == "Miami" |
                         DeID_Final$Child_Ethn == "Irving" |
                         DeID_Final$Child_Ethn == "Unknown " |
                         DeID_Final$Child_Ethn == "W" | 
                         DeID_Final$Child_Ethn == "w"|
                         DeID_Final$Child_Ethn == "w/NA"|
                         DeID_Final$Child_Ethn == "Brown"|
                         DeID_Final$Child_Ethn == "Brown "|
                         DeID_Final$Child_Ethn == "CH"|
                         DeID_Final$Child_Ethn == "European"|
                         DeID_Final$Child_Ethn == "M"|
                         DeID_Final$Child_Ethn == "D"|
                         DeID_Final$Child_Ethn == "N American "|
                         DeID_Final$Child_Ethn == "N. American "|
                         DeID_Final$Child_Ethn == "Same"|
                         DeID_Final$Child_Ethn == "AA"|
                         DeID_Final$Child_Ethn == "2009"|
                         DeID_Final$Child_Ethn == "2011"|
                         DeID_Final$Child_Ethn == "2016"|
                         DeID_Final$Child_Ethn == "male"|
                         DeID_Final$Child_Ethn == "2018"|
                         DeID_Final$Child_Ethn == "Na"|
                         DeID_Final$Child_Ethn == "2013"|
                         DeID_Final$Child_Ethn == "AI"|
                         DeID_Final$Child_Ethn == "American"|
                         DeID_Final$Child_Ethn == "American "|
                         DeID_Final$Child_Ethn == "2014"|
                         DeID_Final$Child_Ethn == "brown"|
                         DeID_Final$Child_Ethn == "2015"|
                         DeID_Final$Child_Ethn == "2017"] <- "Uncategorizable" 

DeID_Final$Child_Ethn[DeID_Final$Child_Ethn == ""] <- "No response"

table(DeID_Final$Child_Ethn)
```





Parent 1/2 Ethnicity
```{r, echo=FALSE}
DeID_Final$Parent1Ethnicity <- DeID_Final$Parent1Ethn
DeID_Final$Parent1Ethnicity[DeID_Final$Parent1Ethnicity == "white"|
                         DeID_Final$Parent1Ethnicity == "White "|
                         DeID_Final$Parent1Ethnicity == "Whitr"|
                         DeID_Final$Parent1Ethnicity == "Wht "|
                         DeID_Final$Parent1Ethnicity == "White, non-Hispanic"|
                         DeID_Final$Parent1Ethnicity == "white/non-hispanic"|
                         DeID_Final$Parent1Ethnicity == "White non hispanic"|
                         DeID_Final$Parent1Ethnicity == "WHITE"|
                         DeID_Final$Parent1Ethnicity == "White/ Caucasian "| 
                         DeID_Final$Parent1Ethnicity == "Caucashion"| 
                         DeID_Final$Parent1Ethnicity == "Caucasi"| 
                         DeID_Final$Parent1Ethnicity == "Cauc."| 
                         DeID_Final$Parent1Ethnicity == "White/non Hispanic "|
                         DeID_Final$Parent1Ethnicity == "white "|
                         DeID_Final$Parent1Ethnicity == "Caucasian "| 
                         DeID_Final$Parent1Ethnicity == "Caucasian"|
                         DeID_Final$Parent1Ethnicity == "White Caucasian"|
                         DeID_Final$Parent1Ethnicity == "White Caucasian "|
                         DeID_Final$Parent1Ethnicity == "caucasian"| 
                         DeID_Final$Parent1Ethnicity == "caucasian "| 
                         DeID_Final$Parent1Ethnicity == "Caucasian, Non-Hispanic"| 
                         DeID_Final$Parent1Ethnicity == "Caucasian/non-Hispanic"| 
                         DeID_Final$Parent1Ethnicity == "Caucasian/White"| 
                         DeID_Final$Parent1Ethnicity == "Caucasion"] <- "White" 

DeID_Final$Parent1Ethnicity[DeID_Final$Parent1Ethnicity == "asian"|
                         DeID_Final$Parent1Ethnicity == "ASIAN"|
                         DeID_Final$Parent1Ethnicity == "Asian "|
                         DeID_Final$Parent1Ethnicity == "Vietnamese "|
                         DeID_Final$Parent1Ethnicity == "Asiann"|
                         DeID_Final$Parent1Ethnicity == "Southeast Asian "|
                         DeID_Final$Parent1Ethnicity == "South Asian"|
                         DeID_Final$Parent1Ethnicity == "south east indian"|
                         DeID_Final$Parent1Ethnicity == "Asian indian"|
                         DeID_Final$Parent1Ethnicity == "Central Asian"|
                         DeID_Final$Parent1Ethnicity == "Chinese"|
                         DeID_Final$Parent1Ethnicity == "Asian, Indian "|
                         DeID_Final$Parent1Ethnicity == "Asian American"|
                         DeID_Final$Parent1Ethnicity == "Asian American "|
                         DeID_Final$Parent1Ethnicity == "AISAN"|
                         DeID_Final$Parent1Ethnicity == "Pakistani "|
                         DeID_Final$Parent1Ethnicity == "Asian XO"|
                         DeID_Final$Parent1Ethnicity == "AsianAmerican"] <- "Asian" 

DeID_Final$Parent1Ethnicity[DeID_Final$Parent1Ethnicity == "Black "|
                         DeID_Final$Parent1Ethnicity == "Blk"|
                         DeID_Final$Parent1Ethnicity == "African American "|
                         DeID_Final$Parent1Ethnicity == "African/American"|
                         DeID_Final$Parent1Ethnicity == "African"|
                         DeID_Final$Parent1Ethnicity == "african/black"|
                         DeID_Final$Parent1Ethnicity == "african/black "|
                         DeID_Final$Parent1Ethnicity == "Bleack"|
                         DeID_Final$Parent1Ethnicity == "Black African American "|
                         DeID_Final$Parent1Ethnicity == "Black American"|
                         DeID_Final$Parent1Ethnicity == "black "|
                         DeID_Final$Parent1Ethnicity == "blacks "|
                         DeID_Final$Parent1Ethnicity == "Blacks "|
                         DeID_Final$Parent1Ethnicity == "BLACK"|
                         DeID_Final$Parent1Ethnicity == "BLACK "|
                         DeID_Final$Parent1Ethnicity == "Black  America "|
                         DeID_Final$Parent1Ethnicity == "Black american"|
                         DeID_Final$Parent1Ethnicity == "Black American "|
                         DeID_Final$Parent1Ethnicity == "African American"|
                         DeID_Final$Parent1Ethnicity == "Blk "] <- "Black" 

DeID_Final$Parent1Ethnicity[DeID_Final$Parent1Ethnicity == "hispanic "|
                         DeID_Final$Parent1Ethnicity == "HISPANIC"|
                         DeID_Final$Parent1Ethnicity == "Hispanic "|
                         DeID_Final$Parent1Ethnicity == "Hispanic"|
                         DeID_Final$Parent1Ethnicity == "Latina"|
                         DeID_Final$Parent1Ethnicity == "Latino"|
                         DeID_Final$Parent1Ethnicity == "latino"|
                         DeID_Final$Parent1Ethnicity == "His"|
                         DeID_Final$Parent1Ethnicity == "Puerto Rico"|
                         DeID_Final$Parent1Ethnicity == "Latin"|
                         DeID_Final$Parent1Ethnicity == "Latin "|
                         DeID_Final$Parent1Ethnicity == "hispanic"] <- "Hispanic/Latino"

DeID_Final$Parent1Ethnicity[DeID_Final$Parent1Ethnicity == "PACIFIC ISLANDER (CHAMORRU, FILIPINO, CHINESE)"|
                         DeID_Final$Parent1Ethnicity == "PI"|
                         DeID_Final$Parent1Ethnicity == "Pacific Islander"|
                         DeID_Final$Parent1Ethnicity == "Asian-Pacific Islander"|
                         DeID_Final$Parent1Ethnicity == "Filipino American"] <- "Pacific Islander" 

DeID_Final$Parent1Ethnicity[DeID_Final$Parent1Ethnicity == "Middle eastern"|
                         DeID_Final$Parent1Ethnicity == "Arab"|
                         DeID_Final$Parent1Ethnicity == "Middle Eastern"|
                         DeID_Final$Parent1Ethnicity == "middle eastern "|
                         DeID_Final$Parent1Ethnicity == "North Africa "|
                         DeID_Final$Parent1Ethnicity == "Middle eastern "] <- "Middle Eastern" 

DeID_Final$Parent1Ethnicity[DeID_Final$Parent1Ethnicity == "Alaska Native"|
                         DeID_Final$Parent1Ethnicity == "indian american "|
                         DeID_Final$Parent1Ethnicity == "indi"|
                         DeID_Final$Parent1Ethnicity == "Indi"|
                         DeID_Final$Parent1Ethnicity == "indian"|
                         DeID_Final$Parent1Ethnicity == "INDIAN"|
                         DeID_Final$Parent1Ethnicity == "West indian"|
                         DeID_Final$Parent1Ethnicity == "West Indian"|
                         DeID_Final$Parent1Ethnicity == "Indian"|
                         DeID_Final$Parent1Ethnicity == "American Indian "|
                         DeID_Final$Parent1Ethnicity == "American Indian/Alaskan Native"|
                         DeID_Final$Parent1Ethnicity == "Indian "|
                         DeID_Final$Parent1Ethnicity == "Appalachian "] <- "American Indian/Alaskan Native" 

DeID_Final$Parent1Ethnicity[DeID_Final$Parent1Ethnicity == "Hmong"] <- "Hmong"

DeID_Final$Parent1Ethnicity[DeID_Final$Parent1Ethnicity == "Multi"|
                         DeID_Final$Parent1Ethnicity == "Multiracial"|
                         DeID_Final$Parent1Ethnicity == "Multiple"|
                         DeID_Final$Parent1Ethnicity == "mixed"|
                         DeID_Final$Parent1Ethnicity == "Caucasian & Pacific Islander"|
                         DeID_Final$Parent1Ethnicity == "Caucasian/Asian "|
                         DeID_Final$Parent1Ethnicity == "Mixed"|
                         DeID_Final$Parent1Ethnicity == "Black/white "|
                         DeID_Final$Parent1Ethnicity == "W/A"|
                         DeID_Final$Parent1Ethnicity == "B/w"|
                         DeID_Final$Parent1Ethnicity == "Mixed - Asian/White"|
                         DeID_Final$Parent1Ethnicity == "W/C"|
                         DeID_Final$Parent1Ethnicity == "Mixed - Asian-White"|
                         DeID_Final$Parent1Ethnicity == "W/B"|
                         DeID_Final$Parent1Ethnicity == "H/AA"|
                         DeID_Final$Parent1Ethnicity == "Wh/Hisp"|
                         DeID_Final$Parent1Ethnicity == "White and Asian American"|
                         DeID_Final$Parent1Ethnicity == "White/middle eastern "|
                         DeID_Final$Parent1Ethnicity == "White/Latino "|
                         DeID_Final$Parent1Ethnicity == "H/AA "|
                         DeID_Final$Parent1Ethnicity == "White/Latino"|
                         DeID_Final$Parent1Ethnicity == "White/Latina"|
                         DeID_Final$Parent1Ethnicity == "Black/White/Non-Hispanic"|
                         DeID_Final$Parent1Ethnicity == "ASIAN INDIAN"|
                         DeID_Final$Parent1Ethnicity == "Asian-Indian"|
                         DeID_Final$Parent1Ethnicity == "asian, white"|
                         DeID_Final$Parent1Ethnicity == "White/mexican"|
                         DeID_Final$Parent1Ethnicity == "White/API"|
                         DeID_Final$Parent1Ethnicity == "White/ Black"|
                         DeID_Final$Parent1Ethnicity == "white, asian"|
                         DeID_Final$Parent1Ethnicity == "asian/white"|
                         DeID_Final$Parent1Ethnicity == "b/w"|
                         DeID_Final$Parent1Ethnicity == "W&L"|
                         DeID_Final$Parent1Ethnicity == "W/H"|
                         DeID_Final$Parent1Ethnicity == "Wh/Hispanic"|
                         DeID_Final$Parent1Ethnicity == "White/Hispanic "|
                         DeID_Final$Parent1Ethnicity == "White/Hispanic"|
                         DeID_Final$Parent1Ethnicity == "White/hispanic"|
                         DeID_Final$Parent1Ethnicity == "White/Asian "|
                         DeID_Final$Parent1Ethnicity == "chinese white"|
                         DeID_Final$Parent1Ethnicity == "Wh/Hispanic "|
                         DeID_Final$Parent1Ethnicity == "Asian white"|
                         DeID_Final$Parent1Ethnicity == "White and Filipino"|
                         DeID_Final$Parent1Ethnicity == "Asian white "|
                         DeID_Final$Parent1Ethnicity == "Asian/Hispanic"|
                         DeID_Final$Parent1Ethnicity == "White/Asian"|
                         DeID_Final$Parent1Ethnicity == "White/asian"|
                         DeID_Final$Parent1Ethnicity == "white, mexican, native american"|
                         DeID_Final$Parent1Ethnicity == "White/ Hispan"|
                         DeID_Final$Parent1Ethnicity == "Asian,Other"|
                         DeID_Final$Parent1Ethnicity == "Asian,Other"|
                         DeID_Final$Parent1Ethnicity == "White/Mex "|
                         DeID_Final$Parent1Ethnicity == "White/Mexican"|
                         DeID_Final$Parent1Ethnicity == "white/asian"|
                         DeID_Final$Parent1Ethnicity == "White/Hispanic/Native American" |
                         DeID_Final$Parent1Ethnicity == "White/Arab"|
                         DeID_Final$Parent1Ethnicity == "white / latino / Native American"|
                         DeID_Final$Parent1Ethnicity == "Asian and Caucasian"|
                         DeID_Final$Parent1Ethnicity == "Asian Caucasian"|
                         DeID_Final$Parent1Ethnicity == "White/ middle eastern "|
                         DeID_Final$Parent1Ethnicity == "white/ hispanic"|
                         DeID_Final$Parent1Ethnicity == "White/ Chinese"|
                         DeID_Final$Parent1Ethnicity == "White Latino"|
                         DeID_Final$Parent1Ethnicity == "White Hispanic"|
                         DeID_Final$Parent1Ethnicity == "Mixed"|
                         DeID_Final$Parent1Ethnicity == "Mixed "|
                         DeID_Final$Parent1Ethnicity == "Japanese and Caicasian"|
                         DeID_Final$Parent1Ethnicity == "Japanese / White"|
                         DeID_Final$Parent1Ethnicity == "Caucasian/Asian"|
                         DeID_Final$Parent1Ethnicity == "Caucasian/Taiwanese"|
                         DeID_Final$Parent1Ethnicity == "caucasian/jewish"|
                         DeID_Final$Parent1Ethnicity == "caucasian-jewish"|
                         DeID_Final$Parent1Ethnicity == "East Asian/white"|
                         DeID_Final$Parent1Ethnicity == "Asian/African American"|
                         DeID_Final$Parent1Ethnicity == "Asian/African American "|
                         DeID_Final$Parent1Ethnicity == "asian/white"|
                         DeID_Final$Parent1Ethnicity == "Asian/white"|
                         DeID_Final$Parent1Ethnicity == "Asian/White"|
                         DeID_Final$Parent1Ethnicity == "B/W"|
                         DeID_Final$Parent1Ethnicity == "biracial"|
                         DeID_Final$Parent1Ethnicity == "Biracial"|
                         DeID_Final$Parent1Ethnicity == "Biracial "|
                         DeID_Final$Parent1Ethnicity == "biracial black white"|
                         DeID_Final$Parent1Ethnicity == "Black hispanic"|
                         DeID_Final$Parent1Ethnicity == "Black/Hispanic"|
                         DeID_Final$Parent1Ethnicity == "Black/White"|
                         DeID_Final$Parent1Ethnicity == "British white indian"|
                         DeID_Final$Parent1Ethnicity == "Chinese Caucasian "|
                         DeID_Final$Parent1Ethnicity == "hispanic/white"|
                         DeID_Final$Parent1Ethnicity == "Haitian/Panamanian/Irish/Italian "|
                         DeID_Final$Parent1Ethnicity == "Hispanic white"|
                         DeID_Final$Parent1Ethnicity == "Hispanic/white"|
                         DeID_Final$Parent1Ethnicity == "Hispanic/White"|
                         DeID_Final$Parent1Ethnicity == "mexican white"|
                         DeID_Final$Parent1Ethnicity == "Indian-persian"|
                         DeID_Final$Parent1Ethnicity == "Caucasian and Asian"|
                         DeID_Final$Parent1Ethnicity == "Chinese white"|
                         DeID_Final$Parent1Ethnicity == "Indian-persian"|
                         DeID_Final$Parent1Ethnicity == "multiracial"|
                         DeID_Final$Parent1Ethnicity == "multi"|
                          DeID_Final$Parent1Ethnicity == "Asian/white "|
                         DeID_Final$Parent1Ethnicity == "Indian-Persian"|
                         DeID_Final$Parent1Ethnicity == "Indian-Persian "|
                         DeID_Final$Parent1Ethnicity == "Asian and White"|
                         DeID_Final$Parent1Ethnicity == "Black,Asian"|
                         DeID_Final$Parent1Ethnicity == "Indian,Asian"|
                         DeID_Final$Parent1Ethnicity == "White,Black"|
                         DeID_Final$Parent1Ethnicity == "White,Indian,Hispanic"|
                         DeID_Final$Parent1Ethnicity == "Asian,Other"|
                         DeID_Final$Parent1Ethnicity == "Black,Hispanic"|
                         DeID_Final$Parent1Ethnicity == "White,Asian"|
                         DeID_Final$Parent1Ethnicity == "White,Black,Indian,Hispanic"|
                         DeID_Final$Parent1Ethnicity == "White,Other"|
                         DeID_Final$Parent1Ethnicity == "White,Asian,Hispanic"|
                         DeID_Final$Parent1Ethnicity == "White,Hispanic"|
                         DeID_Final$Parent1Ethnicity == "Hispanic/asian"] <- "Multiple Categories"


#Uncategorizable (One letter responses like "H" or "CH")
DeID_Final$Parent1Ethnicity[DeID_Final$Parent1Ethnicity == "H"|
                         DeID_Final$Parent1Ethnicity == "h"|
                         DeID_Final$Parent1Ethnicity == "L"| 
                         DeID_Final$Parent1Ethnicity == "c"|
                         DeID_Final$Parent1Ethnicity == "C"|
                         DeID_Final$Parent1Ethnicity == "A"|
                         DeID_Final$Parent1Ethnicity == "N/a"|
                         DeID_Final$Parent1Ethnicity == "Non hospianic"|
                         DeID_Final$Parent1Ethnicity == "B"|
                         DeID_Final$Parent1Ethnicity == "Yes" |
                         DeID_Final$Parent1Ethnicity == "x" |
                         DeID_Final$Parent1Ethnicity == "Miami" |
                         DeID_Final$Parent1Ethnicity == "Irving" |
                         DeID_Final$Parent1Ethnicity == "Unknown " |
                         DeID_Final$Parent1Ethnicity == "W" | 
                         DeID_Final$Parent1Ethnicity == "w"|
                         DeID_Final$Parent1Ethnicity == "w/NA"|
                         DeID_Final$Parent1Ethnicity == "Brown"|
                         DeID_Final$Parent1Ethnicity == "Brown "|
                         DeID_Final$Parent1Ethnicity == "CH"|
                         DeID_Final$Parent1Ethnicity == "European"|
                         DeID_Final$Parent1Ethnicity == "M"|
                         DeID_Final$Parent1Ethnicity == "D"|
                         DeID_Final$Parent1Ethnicity == "N American "|
                         DeID_Final$Parent1Ethnicity == "N. American "|
                         DeID_Final$Parent1Ethnicity == "Same"|
                         DeID_Final$Parent1Ethnicity == "AA"|
                         DeID_Final$Parent1Ethnicity == "2009"|
                         DeID_Final$Parent1Ethnicity == "2011"|
                         DeID_Final$Parent1Ethnicity == "2016"|
                         DeID_Final$Parent1Ethnicity == "male"|
                         DeID_Final$Parent1Ethnicity == "2018"|
                         DeID_Final$Parent1Ethnicity == "Na"|
                         DeID_Final$Parent1Ethnicity == "2013"|
                         DeID_Final$Parent1Ethnicity == "AI"|
                         DeID_Final$Parent1Ethnicity == "American"|
                         DeID_Final$Parent1Ethnicity == "American "|
                         DeID_Final$Parent1Ethnicity == "2014"|
                         DeID_Final$Parent1Ethnicity == "brown"|
                         DeID_Final$Parent1Ethnicity == "2015"|
                         DeID_Final$Parent1Ethnicity == "2017"] <- "Uncategorizable" 

DeID_Final$Parent1Ethnicity[DeID_Final$Parent1Ethnicity == ""] <- "No response"

table(DeID_Final$Parent1Ethnicity)

DeID_Final$Parent2Ethnicity <- DeID_Final$Parent.2.Ethnicity
DeID_Final$Parent2Ethnicity[DeID_Final$Parent2Ethnicity == "white"|
                         DeID_Final$Parent2Ethnicity == "White "|
                         DeID_Final$Parent2Ethnicity == "Whitr"|
                         DeID_Final$Parent2Ethnicity == "Wht "|
                         DeID_Final$Parent2Ethnicity == "White, non-Hispanic"|
                         DeID_Final$Parent2Ethnicity == "white/non-hispanic"|
                         DeID_Final$Parent2Ethnicity == "White non hispanic"|
                         DeID_Final$Parent2Ethnicity == "WHITE"|
                         DeID_Final$Parent2Ethnicity == "White/ Caucasian "| 
                         DeID_Final$Parent2Ethnicity == "Caucashion"| 
                         DeID_Final$Parent2Ethnicity == "Caucasi"| 
                         DeID_Final$Parent2Ethnicity == "Cauc."| 
                         DeID_Final$Parent2Ethnicity == "White/non Hispanic "|
                         DeID_Final$Parent2Ethnicity == "white "|
                         DeID_Final$Parent2Ethnicity == "Caucasian "| 
                         DeID_Final$Parent2Ethnicity == "Caucasian"|
                         DeID_Final$Parent2Ethnicity == "White Caucasian"|
                         DeID_Final$Parent2Ethnicity == "White Caucasian "|
                         DeID_Final$Parent2Ethnicity == "caucasian"| 
                         DeID_Final$Parent2Ethnicity == "caucasian "| 
                         DeID_Final$Parent2Ethnicity == "Caucasian, Non-Hispanic"| 
                         DeID_Final$Parent2Ethnicity == "Caucasian/non-Hispanic"| 
                         DeID_Final$Parent2Ethnicity == "Caucasian/White"| 
                         DeID_Final$Parent2Ethnicity == "Caucasion"] <- "White" 

DeID_Final$Parent2Ethnicity[DeID_Final$Parent2Ethnicity == "asian"|
                         DeID_Final$Parent2Ethnicity == "ASIAN"|
                         DeID_Final$Parent2Ethnicity == "Asian "|
                         DeID_Final$Parent2Ethnicity == "Vietnamese "|
                         DeID_Final$Parent2Ethnicity == "Asiann"|
                         DeID_Final$Parent2Ethnicity == "Southeast Asian "|
                         DeID_Final$Parent2Ethnicity == "South Asian"|
                         DeID_Final$Parent2Ethnicity == "south east indian"|
                         DeID_Final$Parent2Ethnicity == "Asian indian"|
                         DeID_Final$Parent2Ethnicity == "Central Asian"|
                         DeID_Final$Parent2Ethnicity == "Chinese"|
                         DeID_Final$Parent2Ethnicity == "Asian, Indian "|
                         DeID_Final$Parent2Ethnicity == "Asian American"|
                         DeID_Final$Parent2Ethnicity == "Asian American "|
                         DeID_Final$Parent2Ethnicity == "AISAN"|
                         DeID_Final$Parent2Ethnicity == "Pakistani "|
                         DeID_Final$Parent2Ethnicity == "Asian XO"|
                         DeID_Final$Parent2Ethnicity == "AsianAmerican"] <- "Asian" 

DeID_Final$Parent2Ethnicity[DeID_Final$Parent2Ethnicity == "Black "|
                         DeID_Final$Parent2Ethnicity == "Blk"|
                         DeID_Final$Parent2Ethnicity == "African American "|
                         DeID_Final$Parent2Ethnicity == "African/American"|
                         DeID_Final$Parent2Ethnicity == "African"|
                         DeID_Final$Parent2Ethnicity == "african/black"|
                         DeID_Final$Parent2Ethnicity == "african/black "|
                         DeID_Final$Parent2Ethnicity == "Bleack"|
                         DeID_Final$Parent2Ethnicity == "Black African American "|
                         DeID_Final$Parent2Ethnicity == "Black American"|
                         DeID_Final$Parent2Ethnicity == "black "|
                         DeID_Final$Parent2Ethnicity == "blacks "|
                         DeID_Final$Parent2Ethnicity == "Blacks "|
                         DeID_Final$Parent2Ethnicity == "BLACK"|
                         DeID_Final$Parent2Ethnicity == "BLACK "|
                         DeID_Final$Parent2Ethnicity == "Black  America "|
                         DeID_Final$Parent2Ethnicity == "Black american"|
                         DeID_Final$Parent2Ethnicity == "Black American "|
                         DeID_Final$Parent2Ethnicity == "African American"|
                         DeID_Final$Parent2Ethnicity == "Blk "] <- "Black" 

DeID_Final$Parent2Ethnicity[DeID_Final$Parent2Ethnicity == "hispanic "|
                         DeID_Final$Parent2Ethnicity == "HISPANIC"|
                         DeID_Final$Parent2Ethnicity == "Hispanic "|
                         DeID_Final$Parent2Ethnicity == "Hispanic"|
                         DeID_Final$Parent2Ethnicity == "Latina"|
                         DeID_Final$Parent2Ethnicity == "Latino"|
                         DeID_Final$Parent2Ethnicity == "latino"|
                         DeID_Final$Parent2Ethnicity == "His"|
                         DeID_Final$Parent2Ethnicity == "Puerto Rico"|
                         DeID_Final$Parent2Ethnicity == "Latin"|
                         DeID_Final$Parent2Ethnicity == "Latin "|
                         DeID_Final$Parent2Ethnicity == "hispanic"] <- "Hispanic/Latino"

DeID_Final$Parent2Ethnicity[DeID_Final$Parent2Ethnicity == "PACIFIC ISLANDER (CHAMORRU, FILIPINO, CHINESE)"|
                         DeID_Final$Parent2Ethnicity == "PI"|
                         DeID_Final$Parent2Ethnicity == "Pacific Islander"|
                         DeID_Final$Parent2Ethnicity == "Asian-Pacific Islander"|
                         DeID_Final$Parent2Ethnicity == "Filipino American"] <- "Pacific Islander" 

DeID_Final$Parent2Ethnicity[DeID_Final$Parent2Ethnicity == "Middle eastern"|
                         DeID_Final$Parent2Ethnicity == "Arab"|
                         DeID_Final$Parent2Ethnicity == "Middle Eastern"|
                         DeID_Final$Parent2Ethnicity == "middle eastern "|
                         DeID_Final$Parent2Ethnicity == "North Africa "|
                         DeID_Final$Parent2Ethnicity == "Middle eastern "] <- "Middle Eastern" 

DeID_Final$Parent2Ethnicity[DeID_Final$Parent2Ethnicity == "Alaska Native"|
                         DeID_Final$Parent2Ethnicity == "indian american "|
                         DeID_Final$Parent2Ethnicity == "indi"|
                         DeID_Final$Parent2Ethnicity == "Indi"|
                         DeID_Final$Parent2Ethnicity == "indian"|
                         DeID_Final$Parent2Ethnicity == "INDIAN"|
                         DeID_Final$Parent2Ethnicity == "West indian"|
                         DeID_Final$Parent2Ethnicity == "West Indian"|
                         DeID_Final$Parent2Ethnicity == "Indian"|
                         DeID_Final$Parent2Ethnicity == "American Indian "|
                         DeID_Final$Parent2Ethnicity == "American Indian/Alaskan Native"|
                         DeID_Final$Parent2Ethnicity == "Indian "|
                         DeID_Final$Parent2Ethnicity == "Appalachian "] <- "American Indian/Alaskan Native" 

DeID_Final$Parent2Ethnicity[DeID_Final$Parent2Ethnicity == "Hmong"] <- "Hmong"

DeID_Final$Parent2Ethnicity[DeID_Final$Parent2Ethnicity == "Multi"|
                         DeID_Final$Parent2Ethnicity == "Multiracial"|
                         DeID_Final$Parent2Ethnicity == "Multiple"|
                         DeID_Final$Parent2Ethnicity == "mixed"|
                         DeID_Final$Parent2Ethnicity == "Caucasian & Pacific Islander"|
                         DeID_Final$Parent2Ethnicity == "Caucasian/Asian "|
                         DeID_Final$Parent2Ethnicity == "Mixed"|
                         DeID_Final$Parent2Ethnicity == "Black/white "|
                         DeID_Final$Parent2Ethnicity == "W/A"|
                         DeID_Final$Parent2Ethnicity == "B/w"|
                         DeID_Final$Parent2Ethnicity == "Mixed - Asian/White"|
                         DeID_Final$Parent2Ethnicity == "W/C"|
                         DeID_Final$Parent2Ethnicity == "Mixed - Asian-White"|
                         DeID_Final$Parent2Ethnicity == "W/B"|
                         DeID_Final$Parent2Ethnicity == "H/AA"|
                         DeID_Final$Parent2Ethnicity == "Wh/Hisp"|
                         DeID_Final$Parent2Ethnicity == "White and Asian American"|
                         DeID_Final$Parent2Ethnicity == "White/middle eastern "|
                         DeID_Final$Parent2Ethnicity == "White/Latino "|
                         DeID_Final$Parent2Ethnicity == "H/AA "|
                         DeID_Final$Parent2Ethnicity == "White/Latino"|
                         DeID_Final$Parent2Ethnicity == "White/Latina"|
                         DeID_Final$Parent2Ethnicity == "Black/White/Non-Hispanic"|
                         DeID_Final$Parent2Ethnicity == "ASIAN INDIAN"|
                         DeID_Final$Parent2Ethnicity == "Asian-Indian"|
                         DeID_Final$Parent2Ethnicity == "asian, white"|
                         DeID_Final$Parent2Ethnicity == "White/mexican"|
                         DeID_Final$Parent2Ethnicity == "White/API"|
                         DeID_Final$Parent2Ethnicity == "White/ Black"|
                         DeID_Final$Parent2Ethnicity == "white, asian"|
                         DeID_Final$Parent2Ethnicity == "asian/white"|
                         DeID_Final$Parent2Ethnicity == "b/w"|
                         DeID_Final$Parent2Ethnicity == "W&L"|
                         DeID_Final$Parent2Ethnicity == "W/H"|
                         DeID_Final$Parent2Ethnicity == "Wh/Hispanic"|
                         DeID_Final$Parent2Ethnicity == "White/Hispanic "|
                         DeID_Final$Parent2Ethnicity == "White/Hispanic"|
                         DeID_Final$Parent2Ethnicity == "White/hispanic"|
                         DeID_Final$Parent2Ethnicity == "White/Asian "|
                         DeID_Final$Parent2Ethnicity == "chinese white"|
                         DeID_Final$Parent2Ethnicity == "Wh/Hispanic "|
                         DeID_Final$Parent2Ethnicity == "Asian white"|
                         DeID_Final$Parent2Ethnicity == "White and Filipino"|
                         DeID_Final$Parent2Ethnicity == "Asian white "|
                         DeID_Final$Parent2Ethnicity == "Asian/Hispanic"|
                         DeID_Final$Parent2Ethnicity == "White/Asian"|
                         DeID_Final$Parent2Ethnicity == "White/asian"|
                         DeID_Final$Parent2Ethnicity == "white, mexican, native american"|
                         DeID_Final$Parent2Ethnicity == "White/ Hispan"|
                         DeID_Final$Parent2Ethnicity == "White/Mex "|
                         DeID_Final$Parent2Ethnicity == "White/Mexican"|
                         DeID_Final$Parent2Ethnicity == "white/asian"|
                         DeID_Final$Parent2Ethnicity == "White/Hispanic/Native American" |
                         DeID_Final$Parent2Ethnicity == "White/Arab"|
                         DeID_Final$Parent2Ethnicity == "white / latino / Native American"|
                         DeID_Final$Parent2Ethnicity == "Asian and Caucasian"|
                         DeID_Final$Parent2Ethnicity == "Asian Caucasian"|
                         DeID_Final$Parent2Ethnicity == "White/ middle eastern "|
                         DeID_Final$Parent2Ethnicity == "white/ hispanic"|
                         DeID_Final$Parent2Ethnicity == "White/ Chinese"|
                         DeID_Final$Parent2Ethnicity == "White Latino"|
                         DeID_Final$Parent2Ethnicity == "White Hispanic"|
                         DeID_Final$Parent2Ethnicity == "Mixed"|
                         DeID_Final$Parent2Ethnicity == "Asian,Other"|
                         DeID_Final$Parent2Ethnicity == "Black,Other"|
                         DeID_Final$Parent2Ethnicity == "Indian,Hispanic"|
                         DeID_Final$Parent2Ethnicity == "White,Hispanic"|
                         DeID_Final$Parent2Ethnicity == "Black,Hispanic"|
                         DeID_Final$Parent2Ethnicity == "White,Hispanic"|
                         DeID_Final$Parent2Ethnicity == "Mixed "|
                         DeID_Final$Parent2Ethnicity == "Japanese and Caicasian"|
                         DeID_Final$Parent2Ethnicity == "Japanese / White"|
                         DeID_Final$Parent2Ethnicity == "Caucasian/Asian"|
                         DeID_Final$Parent2Ethnicity == "Caucasian/Taiwanese"|
                         DeID_Final$Parent2Ethnicity == "caucasian/jewish"|
                         DeID_Final$Parent2Ethnicity == "caucasian-jewish"|
                         DeID_Final$Parent2Ethnicity == "East Asian/white"|
                         DeID_Final$Parent2Ethnicity == "Asian/African American"|
                         DeID_Final$Parent2Ethnicity == "Asian/African American "|
                         DeID_Final$Parent2Ethnicity == "asian/white"|
                         DeID_Final$Parent2Ethnicity == "Asian/white"|
                         DeID_Final$Parent2Ethnicity == "Asian/White"|
                         DeID_Final$Parent2Ethnicity == "B/W"|
                         DeID_Final$Parent2Ethnicity == "biracial"|
                         DeID_Final$Parent2Ethnicity == "Biracial"|
                         DeID_Final$Parent2Ethnicity == "Biracial "|
                         DeID_Final$Parent2Ethnicity == "biracial black white"|
                         DeID_Final$Parent2Ethnicity == "Black hispanic"|
                         DeID_Final$Parent2Ethnicity == "Black/Hispanic"|
                         DeID_Final$Parent2Ethnicity == "Black/White"|
                         DeID_Final$Parent2Ethnicity == "British white indian"|
                         DeID_Final$Parent2Ethnicity == "Chinese Caucasian "|
                         DeID_Final$Parent2Ethnicity == "hispanic/white"|
                         DeID_Final$Parent2Ethnicity == "Haitian/Panamanian/Irish/Italian "|
                         DeID_Final$Parent2Ethnicity == "Hispanic white"|
                         DeID_Final$Parent2Ethnicity == "Hispanic/white"|
                         DeID_Final$Parent2Ethnicity == "Hispanic/White"|
                         DeID_Final$Parent2Ethnicity == "mexican white"|
                         DeID_Final$Parent2Ethnicity == "Indian-persian"|
                         DeID_Final$Parent2Ethnicity == "Caucasian and Asian"|
                         DeID_Final$Parent2Ethnicity == "Chinese white"|
                         DeID_Final$Parent2Ethnicity == "Indian-persian"|
                         DeID_Final$Parent2Ethnicity == "multiracial"|
                         DeID_Final$Parent2Ethnicity == "multi"|
                         DeID_Final$Parent2Ethnicity == "Asian/white "|
                         DeID_Final$Parent2Ethnicity == "White,Black"|
                         DeID_Final$Parent2Ethnicity == "White,Other"|
                         DeID_Final$Parent2Ethnicity == "White,Asian"|
                         DeID_Final$Parent2Ethnicity == "Hispanic,Other"|
                         DeID_Final$Parent2Ethnicity == "Indian-Persian"|
                         DeID_Final$Parent2Ethnicity == "Indian-Persian "|
                         DeID_Final$Parent2Ethnicity == "Asian and White"|
                         DeID_Final$Parent2Ethnicity == "Hispanic/asian"] <- "Multiple Categories"


#Uncategorizable (One letter responses like "H" or "CH")
DeID_Final$Parent2Ethnicity[DeID_Final$Parent2Ethnicity == "H"|
                         DeID_Final$Parent2Ethnicity == "h"|
                         DeID_Final$Parent2Ethnicity == "L"| 
                         DeID_Final$Parent2Ethnicity == "c"|
                         DeID_Final$Parent2Ethnicity == "C"|
                         DeID_Final$Parent2Ethnicity == "Other"|
                         DeID_Final$Parent2Ethnicity == "A"|
                         DeID_Final$Parent2Ethnicity == "N/a"|
                         DeID_Final$Parent2Ethnicity == "Non hospianic"|
                         DeID_Final$Parent2Ethnicity == "B"|
                         DeID_Final$Parent2Ethnicity == "Yes" |
                         DeID_Final$Parent2Ethnicity == "x" |
                         DeID_Final$Parent2Ethnicity == "Miami" |
                         DeID_Final$Parent2Ethnicity == "Irving" |
                         DeID_Final$Parent2Ethnicity == "Unknown " |
                         DeID_Final$Parent2Ethnicity == "W" | 
                         DeID_Final$Parent2Ethnicity == "w"|
                         DeID_Final$Parent2Ethnicity == "w/NA"|
                         DeID_Final$Parent2Ethnicity == "Brown"|
                         DeID_Final$Parent2Ethnicity == "Brown "|
                         DeID_Final$Parent2Ethnicity == "CH"|
                         DeID_Final$Parent2Ethnicity == "European"|
                         DeID_Final$Parent2Ethnicity == "M"|
                         DeID_Final$Parent2Ethnicity == "D"|
                         DeID_Final$Parent2Ethnicity == "N American "|
                         DeID_Final$Parent2Ethnicity == "N. American "|
                         DeID_Final$Parent2Ethnicity == "Same"|
                         DeID_Final$Parent2Ethnicity == "AA"|
                         DeID_Final$Parent2Ethnicity == "2009"|
                         DeID_Final$Parent2Ethnicity == "2011"|
                         DeID_Final$Parent2Ethnicity == "2016"|
                         DeID_Final$Parent2Ethnicity == "male"|
                         DeID_Final$Parent2Ethnicity == "2018"|
                         DeID_Final$Parent2Ethnicity == "Na"|
                         DeID_Final$Parent2Ethnicity == "2013"|
                         DeID_Final$Parent2Ethnicity == "AI"|
                         DeID_Final$Parent2Ethnicity == "American"|
                         DeID_Final$Parent2Ethnicity == "American "|
                         DeID_Final$Parent2Ethnicity == "2014"|
                         DeID_Final$Parent2Ethnicity == "brown"|
                         DeID_Final$Parent2Ethnicity == "2015"|
                         DeID_Final$Parent2Ethnicity == "2017"] <- "Uncategorizable" 

DeID_Final$Parent2Ethnicity[DeID_Final$Parent2Ethnicity == ""] <- "No response"

table(DeID_Final$Parent2Ethnicity)
```


Parent 1/2 Religion
```{r, echo=FALSE}
# Clean up parent1 religion
DeID_Final$Parent1Religion[DeID_Final$Parent1.Religion %in% c("christian", "Christian", "non-demoninational christian", "Nondenominational Christian", "Christian, Non-demoninational", "Born Again Christian", "Christian but I don't practice", "christian but I don't practice", "Greek orthodox", "Greek Orthodox", "Eastern Orthodox", "Christian based", "Christian- I guess", "Orthodox Christian", "Non-denominational Christian", "Non-denominational Christian ", "Christian - Protestant", "Protestant", "Congregationalist", "Protestant ", "Protestant Christian", "Nondenominational Christian ", "Christian - United Methodist", "United Methodist", "Lutheran", "Lutheran ", "Methodist ", "lutheran", "Presbyterian", "Christian (non-denominational)", "Episcopalian", "Christian - Presbyterian", "Christian based ", "Christian, Non-denominational", "Christianity", "Episcopal", "Episcopalian ")] <- "Christian"

DeID_Final$Parent1Religion[DeID_Final$Parent1.Religion %in% c("Catholic", "catholic", " Catholic", "catholic but I don't practice", "Catholic but I don't practice", "Roman Catholic", "RC", "catholic ", "Roman catholic", "roman catholic", "Reluctantly Catholic", "Ukrainian catholic", "Catholicism", "ROMAN CATHOLIC", "Roman Catholic ")] <- "Catholic"

DeID_Final$Parent1Religion[DeID_Final$Parent1.Religion %in% c("jewish", "Jewish ", "Jewish, non practicing ", "Jewish", "Jew", "Judaism", "judaism", "Jewish, non practicing")] <- "Judaism"

DeID_Final$Parent1Religion[DeID_Final$Parent1.Religion %in% c("LDS", "Mormon", "LDS ", "Mormon ", "Later Day Saint", "Latter-day saints", "Latter-Day saints", "Latter-Day Saints", "Mormon", "Church of Jesus Christ of latter day saints", "Church of Jesus Christ of Latter Day Saintsq", "Church of Latter-day Saint", "Latter-day Saint", "mormon", "Church of Jesus Christ of Latter Day Saints", "Church of Jesus Christ of latter day saints ", "Church of Jesus Christ of latter-day saints", "Church of Jesus Christ of Latter-day Saints", "Church of Jesus Christ of Latter-Day Saints", "I am a member of the Church of Jesus Christ of Latter-day Saints")] <- "LDS"

DeID_Final$Parent1Religion[DeID_Final$Parent1.Religion %in% c("hindu", "Hindu", "hinduism", "Hinduism", "Hindhu", "hindhu", "hindu ", "HINDUISM")] <- "Hindu"

DeID_Final$Parent1Religion[DeID_Final$Parent1.Religion %in% c(" Islam", "Islam ", "Secular Muslim ", "Muslim ", "Islam", "islam", "muslim", "Muslim", "Secular Muslim")] <- "Islam"

DeID_Final$Parent1Religion[DeID_Final$Parent1.Religion %in% c("agnostic", "Agnostic ", "not sure", "idk", "Agnostic", "Agnostic.")] <- "Agnostic"

DeID_Final$Parent1Religion[DeID_Final$Parent1.Religion %in% c("Atheist", "atheist", "none", "No", "not religious", "None ", "None", "None; agnostic", "None specific", "None; Agnostic", "not religious", "None specific ", "N/A", "NA", "Non-religious", "No", "n/a", "na", "non religion", "none / atheist", "no")] <- "Atheist"

DeID_Final$Parent1Religion[DeID_Final$Parent1.Religion %in% c(" Indian", "None; agnostic", "Indian ", "raised LDS", "Spiritual Agnostic ", "Born Catholic ")] <- "Uncategorizable"

DeID_Final$Parent1Religion[DeID_Final$Parent1.Religion %in% c("pagan", "Satanic", "Sikh", "Spiritual", "Spiritual ", "Unitarian Universalist ", "Buddhism/ Roman Catholic ", "Buddhist", "Buddhist ")] <- "Other"

DeID_Final$Parent1Religion[DeID_Final$Parent1.Religion %in% c("")] <- "Not Answered"

# Print the updated table
table(DeID_Final$Parent1Religion)


# Clean up parent2 religion
DeID_Final$Parent2Religion[DeID_Final$Parent.2.Religion %in% c("christian", "Christian", "non-demoninational christian", "Nondenominational Christian", "Christian, Non-demoninational", "Born Again Christian", "Christian but I don't practice", "christian but I don't practice", "Greek orthodox", "Greek Orthodox", "Eastern Orthodox", "Christian based", "Christian- I guess", "Orthodox Christian", "Non-denominational Christian", "Non-denominational Christian ", "Christian - Protestant", "Protestant", "Congregationalist", "Protestant ", "Protestant Christian", "Nondenominational Christian ", "Christian - United Methodist", "United Methodist", "Lutheran", "Lutheran ", "Methodist ", "lutheran", "Presbyterian", "Christian (non-denominational)", "Episcopalian", "Christian - Presbyterian", "Christian based ", "Christian, Non-denominational", "Christianity", "Episcopal", "Episcopalian ")] <- "Christian"

DeID_Final$Parent2Religion[DeID_Final$Parent.2.Religion %in% c("Catholic", "catholic", " Catholic", "catholic but I don't practice", "Catholic but I don't practice", "Roman Catholic", "RC", "catholic ", "Roman catholic", "roman catholic", "Reluctantly Catholic", "Ukrainian catholic", "Catholicism", "ROMAN CATHOLIC", "Roman Catholic ")] <- "Catholic"

DeID_Final$Parent2Religion[DeID_Final$Parent.2.Religion %in% c("jewish", "Jewish ", "Jewish, non practicing ", "Jewish", "Jew", "Judaism", "judaism", "Jewish, non practicing")] <- "Judaism"

DeID_Final$Parent2Religion[DeID_Final$Parent.2.Religion %in% c("LDS", "Mormon", "LDS ", "Mormon ", "Later Day Saint", "Latter-day saints", "Latter-Day saints", "Latter-Day Saints", "Mormon", "Church of Jesus Christ of latter day saints", "Church of Jesus Christ of Latter Day Saintsq", "Church of Latter-day Saint", "Latter-day Saint", "mormon", "Church of Jesus Christ of Latter Day Saints", "Church of Jesus Christ of latter day saints ", "Church of Jesus Christ of latter-day saints", "Church of Jesus Christ of Latter-day Saints", "Church of Jesus Christ of Latter-Day Saints", "I am a member of the Church of Jesus Christ of Latter-day Saints")] <- "LDS"

DeID_Final$Parent2Religion[DeID_Final$Parent.2.Religion %in% c("hindu", "Hindu", "hinduism", "Hinduism", "Hindhu", "hindhu", "hindu ", "HINDUISM")] <- "Hindu"

DeID_Final$Parent2Religion[DeID_Final$Parent.2.Religion %in% c(" Islam", "Islam ", "Secular Muslim ", "Muslim ", "Islam", "islam", "muslim", "Muslim", "Secular Muslim")] <- "Islam"

DeID_Final$Parent2Religion[DeID_Final$Parent.2.Religion %in% c("agnostic", "Agnostic ", "not sure", "idk", "Agnostic", "Agnostic.")] <- "Agnostic"

DeID_Final$Parent2Religion[DeID_Final$Parent.2.Religion %in% c("Atheist", "atheist", "none", "No", "not religious", "None ", "None", "None; agnostic", "None specific", "None; Agnostic", "not religious", "None specific ", "N/A", "NA", "Non-religious", "No", "n/a", "na", "non religion", "none / atheist", "no")] <- "Atheist"

DeID_Final$Parent2Religion[DeID_Final$Parent.2.Religion %in% c(" Indian", "None; agnostic", "Indian ", "raised LDS", "Spiritual Agnostic ", "Born Catholic ")] <- "Uncategorizable"

DeID_Final$Parent2Religion[DeID_Final$Parent.2.Religion %in% c("pagan", "Satanic", "Sikh", "Spiritual", "Spiritual ", "Unitarian Universalist ", "Buddhism/ Roman Catholic ", "Buddhist", "Buddhist ")] <- "Other"

DeID_Final$Parent2Religion[DeID_Final$Parent.2.Religion %in% c("")] <- "Not Answered"

# Print the updated table
table(DeID_Final$Parent2Religion)
```


JWB Sum
```{r, include = FALSE}
# Function to map responses to numeric values
map_responses <- function(response) {
  ifelse(response %in% c("Strongly disagree"), 1,
         ifelse(response %in% c("Disagree"), 2,
                ifelse(response %in% c("Slightly disagree"), 3,
                       ifelse(response %in% c("Slightly agree"), 4,
                              ifelse(response %in% c("Agree"), 5,
                                     ifelse(response %in% c("Strongly agree"), 6, NA))))))  
}

# Columns to be converted for JWB
columns_to_convert_JWB <- c("jwb_teaching_1", "jwb_teaching_2", "jwb_teaching_3", "jwb_teaching_4", "jwb_teaching_5", "jwb_teaching_6", "jwb_teaching_7")

# Convert responses to numeric values for JWB
DeID_Final[columns_to_convert_JWB] <- lapply(DeID_Final[columns_to_convert_JWB], map_responses)

# Calculate the numeric sum of responses for each row for JWB
DeID_Final$JWB <- rowSums(DeID_Final[columns_to_convert_JWB], na.rm = FALSE)
```



InGroup Sum
```{r, include = FALSE}
# Function to map responses to numeric values
map_responses <- function(response) {
  ifelse(response %in% c("Strongly Disagree", "1"), 1,
         ifelse(response %in% c("Moderately Disagree", "2"), 2,
                ifelse(response %in% c("Slightly Disagree", "3"), 3,
                       ifelse(response %in% c("Slightly Agree", "4"), 4,
                              ifelse(response %in% c("Moderately Agree", "5"), 5,
                                     ifelse(response %in% c("Strongly Agree", "6"), 6, NA))))))  
}

# Columns to be converted for InGroup
columns_to_convert_InGroup <- c("LoveforCountry", "GroupBetrayal", "Q44", "CountryHistory", "LoyalFamily", "TeamPlayer")

# Convert responses to numeric values for InGroup
DeID_Final[columns_to_convert_InGroup] <- lapply(DeID_Final[columns_to_convert_InGroup], map_responses)

# Calculate the numeric sum of responses for each row for InGroup
DeID_Final$InGroup <- rowSums(DeID_Final[columns_to_convert_InGroup], na.rm = TRUE)
```





# Graphs
Re-leveling and plotting Graphs

Household income
```{r, echo=FALSE}
DeID_Final$household.income <- as.factor(DeID_Final$household.income)

# Define the custom order for household income levels
income_levels <- c(
  "$0 - $25,000", "$25,001 - $50,000", "$50,001 - $75,000", "$75,001 - $100,000",
  "$100,001 - $125,000", "$125,001 - $150,000", "$150,001 - $175,000",
  "$175,001 - $200,000", "$200,001+",
  "I would rather not say"
)

# Relevel the factor for household income using the custom order
DeID_Final$household.income <- factor(DeID_Final$household.income, levels = income_levels)

# Plot the graph
DeID_Final %>% 
  ggplot(aes(x = household.income, fill = household.income)) + 
  geom_bar() +
  labs(title = "Household Income") +
  xlab("Income Range") +
  ylab("Count")
```


Graphing repeat participants
```{r, echo=FALSE}
DeID_Final %>% group_by(n_Appointments) %>% dplyr::summarise(mean=mean(n_Appointments), number_Appointments = n()) %>%
  ggplot(aes(x=as.factor(n_Appointments),y= number_Appointments, fill=as.factor(n_Appointments))) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = number_Appointments), vjust = 0) +
  labs(title = "How many times does each child participate in one year?", x= "Number of times participated", y="Number of children") 

DEID_ND %>% group_by(n_Appointments) %>% dplyr::summarise(mean=mean(n_Appointments), number_Appointments = n()) %>%
  ggplot(aes(x=as.factor(n_Appointments),y= number_Appointments, fill=as.factor(n_Appointments))) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = number_Appointments), vjust = 0) +
  labs(title = "How many times does each family participate in one year?", x= "Number of times participated", y="Number of families")
```


Parent 1 Party/Politics Graph
```{r, echo=FALSE}
## Parent 1 Party/Politics

# Define the custom order for Parent 1 Political Ideology
custom_order <- c("Very Conservative", "Somewhat Conservative", "Moderate", "Somewhat Liberal", "Very Liberal")

# Relevel the factor for Parent.1.Political using the custom order
DeID_Final$Parent.1.Political <- factor(DeID_Final$Parent.1.Political, levels = custom_order)

# Plot the re-levelled graph for Parent 1 Political Party
DeID_Final %>% ggplot(aes(x = Parent.1.Party, fill = Parent.1.Party)) + 
  geom_bar() +
  labs(title = "Parent 1 Political Party")

# Plot the re-levelled graph for Parent 1 Political Ideology
DeID_Final %>% ggplot(aes(x = Parent.1.Political, fill = Parent.1.Political)) + 
  geom_bar() +
  labs(title = "Parent 1 Political Ideology")
```


Parent 2 Party/Politics Graph
```{r, echo=FALSE}
## Parent 2 Party/Politics
# Define the custom order for Parent 2 Political Ideology
custom_order <- c("Very Conservative", "Somewhat Conservative", "Moderate", "Somewhat Liberal", "Very Liberal")

# Relevel the factor for Parent.2.Political using the custom order
DeID_Final$Parent.2.Political <- factor(DeID_Final$Parent.2.Political, levels = custom_order)

# Plot the re-levelled graph for Parent 2 Political Party
DeID_Final %>% ggplot(aes(x = Parent.2.Party, fill = Parent.2.Party)) + 
  geom_bar() +
  labs(title = "Parent 2 Political Party")

# Plot the re-levelled graph for Parent 2 Political Ideology
DeID_Final %>% ggplot(aes(x = Parent.2.Political, fill = Parent.2.Political)) + 
  geom_bar() +
  labs(title = "Parent 2 Political Ideology")
```


Religion Graphs
```{r, echo=FALSE}
## Religiosity

# Define the order of the levels for the religiosity variable
religiosity_order <- c("Not at all religious", "A little religious", "Moderately religious", "Very religious")

# Convert the religiosity columns to factors with custom levels order
DeID_Final$Parent1Religiosity <- factor(DeID_Final$Parent1Religiosity, levels = religiosity_order)
DeID_Final$Parent.2.Religiosity <- factor(DeID_Final$Parent.2.Religiosity, levels = religiosity_order)

# Plot Parent1Religiosity
ggplot(DeID_Final, aes(x = Parent1Religiosity, fill = Parent1Religiosity)) +
  geom_bar() +
  labs(title = "Parent 1 Religiosity",
       x = "Religiosity",
       y = "Count")

# Plot Parent.2.Religiosity
ggplot(DeID_Final, aes(x = Parent.2.Religiosity, fill = Parent.2.Religiosity)) +
  geom_bar() +
  labs(title = "Parent 2 Religiosity",
       x = "Religiosity",
       y = "Count")

# Plot Parent1Religion
ggplot(DeID_Final, aes(x = Parent1Religion, fill = Parent1Religion)) +
  geom_bar() +
  labs(title = "Parent 1 Religion",
       x = "Religion",
       y = "Count")

# Plot Parent2Religion
ggplot(DeID_Final, aes(x = Parent2Religion, fill = Parent2Religion)) +
  geom_bar() +
  labs(title = "Parent 2 Religion",
       x = "Religion",
       y = "Count")
```


Education Graph(s)
```{r, echo=FALSE}
## Education

# Convert "Parent.1.Education" and "Parent.2.Education" to factors with custom levels
education_levels <- c("No answer", "High School", "Associate's Degree", "Bachelor's Degree", "Graduate Degree")

# Set "NA" values to "No answer"
DeID_Final$Parent.1.Education[is.na(DeID_Final$Parent.1.Education)] <- "No answer"
DeID_Final$Parent.2.Education[is.na(DeID_Final$Parent.2.Education)] <- "No answer"

DeID_Final$Parent.1.Education <- factor(DeID_Final$Parent.1.Education, levels = education_levels)
DeID_Final$Parent.2.Education <- factor(DeID_Final$Parent.2.Education, levels = education_levels)

# Plot the count of each education level for Parent 1
ggplot(DeID_Final, aes(x = Parent.1.Education, fill = Parent.1.Education)) +
  geom_bar() +
  labs(title = "Parent 1 Education") +
  xlab("Education Level") +
  ylab("Count")

# Plot the count of each education level for Parent 2
ggplot(DeID_Final, aes(x = Parent.2.Education, fill = Parent.2.Education)) +
  geom_bar() +
  labs(title = "Parent 2 Education") +
  xlab("Education Level") +
  ylab("Count")
```



When do we get most of our participants?
```{r, echo=FALSE}
# Convert to factors with custom levels
month_levels <- c("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December")

DeID_Final$Study_Month <- factor(DeID_Final$Study_Month, levels = month_levels)

# Plot when we get participants
ggplot(DeID_Final, aes(x = Study_Month, fill = Study_Month)) +
  geom_bar() +
  labs(title = "Appointments by Month") +
  xlab("Months") +
  ylab("Count")
```


Mapping Participants
```{r, echo=FALSE, message = FALSE}
# Round the latitude and longitude columns to 5 decimal points
raw$LocationLatitude <- as.numeric(raw$LocationLatitude)
raw$LocationLongitude <- as.numeric(raw$LocationLongitude)

raw$LocationLatitude <- round(raw$LocationLatitude, 3)
raw$LocationLongitude <- round(raw$LocationLongitude, 3)

# Make the Graph

world_map <- borders("world", color = "black", fill = "grey90")
map_plot <- ggplot() + world_map +
  coord_cartesian(ylim = c(-50, 70))

participant_map <- map_plot +  # Use ggplot() to initiate the ggplot2 object
  geom_point(
    data = raw, aes(x = LocationLongitude, y = LocationLatitude), color = "darkgreen", size = 2, shape = 18) +  # Add a point layer
  ggtitle("                             How Representative is Our Data?") + # Set the title
  labs(x = "Longitude", y = "Latitude") +
  theme(legend.justification = "center") +  # Customize the theme
  theme(legend.position = "bottom")

print(participant_map)
```
